---
title: Places Serviceプロパティ用のルールの作成
description: '配置SDKは、現在の場所を追跡し、現在の場所の周りで設定済みのPOIを監視し、これらのPOIの入口と出口のイベントを追跡します。 '
translation-type: tm+mt
source-git-commit: c22efc36f2eac6b20fc555d998c3988d8c31169e
workflow-type: tm+mt
source-wordcount: '927'
ht-degree: 14%

---


# 入口と出口のルールを作成{#create-entry-exit-rules}

Places拡張機能とPlaces Monitor拡張機能をモバイルアプリケーションにインストールすると、場所の入口データや出口イベントを含む、トリガーまたは条件付きの場所データを、Adobe Experience Platform Launchでルールを作成できます。

## ルール

イベント、条件、およびアクションで構成されるルールを設定できます。 各ルールは、次の内容で構成されます。

* 1つ以上のイベント
* （オプション）条件
* 1つ以上のアクション

### Placesサービスイベント

サービスオファーに、ルールを実行できる次のイベントを配置します。

* **POI**&#x200B;と入力します。これは、設定したPOIに顧客が入ったときに、Places SDKによってトリガーされます。
* **出口POI**。顧客が設定したPOIから離れたときに、Places SDKによってトリガーされます。

### サービス条件を配置

条件は、イベントに関連付けられたデータ、またはそのインスタンスの拡張の共有状態が、アクションを実行するために満たす必要がある条件を定義します。 例えば、サンフランシスコ市内の喫茶店への入口に対するアクションをトリガーする条件を設定できます。

配置SDKは次の状態を維持します。

* 現在のPOI。顧客の所在地のPOIを指します。
* 最後に離脱したPOI。顧客が最後に離脱したPOIを示します。
* 最後に入力されたPOI。顧客が入力した最新のPOIを示します。

各POIには、次のデータ要素が含まれます。

* ID
* 名前
* 緯度/経度
* 半径
* 市区町村、国、州、カテゴリなどのメタデータ

### アクション

アクションは、呼び出されたイベントがルールの条件を満たした場合にアプリが実行する動作を定義します。 例えば、顧客がPOIを入力した場合に、モバイルデバイスに表示するようにお知らせメッセージを設定できます。

## ルールの作成：例

>[!CAUTION]
>
>この例では、米国内の全コーヒーショップの POI ライブラリを作成済みであることを前提としています。POIとライブラリの作成について詳しくは、[POI](/help/poi-mgmt-ui/create-a-poi-ui.md)を作成するおよび&#x200B;*複数のライブラリを管理する](https://docs.adobe.com/content/help/en/places/using/poi-mgmt-ui/manage-libraries-in-the-places-ui.html)の[ライブラリを作成するを参照してください。*

以下の手順は、サンフランシスコで喫茶店に入ったときにSlackに投稿を返すルールの作成方法の例です。

イベント、条件およびアクションは、次の方法で定義します。

* **イベント**:入力イベントを配置します。
* **条件**：**現在の POI** の市区町村はサンフランシスコ
* **アクション**:顧客が入力した喫茶店の名前をSlackにポストバックします。

### 前提条件

ルールを作成する前に、Adobe Experience Platform Launchでデータ要素を作成する必要があります。 データ要素は、ポストバックメッセージにPOIに関して必要な情報を自動的に入力します。

Experience Platform Launchでデータ要素を作成するには：

1. 「**データ要素**」タブをクリックします。
1. 「**追加データ要素**」をクリックします。
1. 名前を入力します（例：**現在のコーヒーショップ名**）。
1. 「**拡張子**」ドロップダウンリストで、「**場所 — ベータ版**」を選択します。
1. 「**データ要素**」で「**市区町村**」を選択します。
1. 右側のウィンドウで、「**現在のPOI**」を選択します。
1. 「**保存**」をクリックします。

### Places ServiceのExperience Platform Launchでのルールの作成

![ルールの作成](/help/assets/placesrule.png)

1. Experience Platform Launch で、「**[!UICONTROL ルール]**」タブをクリックします。
1. 「**[!UICONTROL Add Rule]**」をクリックします。
1. ルールの名前を入力します（例：**[!UICONTROL SF]**&#x200B;の喫茶店のトラックエントリ）。

### イベントの作成

1. 「イベント」セクションで、**[!UICONTROL +追加]**&#x200B;をクリックします。 イベントは、ルールをいつ実行するかを決定します。
1. 「**[!UICONTROL 拡張子]**」ドロップダウンリストで、「**[!UICONTROL 場所 — ベータ版]**」を選択します。
1. **[!UICONTROL イベントタイプ]**&#x200B;ドロップダウンリストで、「**[!UICONTROL POI を入力]**」を選択します。
1. 「**[!UICONTROL 名前]**」に、イベントの名前を入力します（例：「**[!UICONTROL コーヒーショップへの来店]**」）。
1. 「**[!UICONTROL 変更を保存]**」をクリックします。

### 条件の作成

1. 「条件」セクションで、**[!UICONTROL +追加]**&#x200B;をクリックします。 条件は、アクションを実行するために満たす必要がある条件を決定します。
1. 「**[!UICONTROL 論理タイプ]**」で「標準」を選択し、条件が満たされた場合にアクションを実行できます。
1. 「**[!UICONTROL 拡張子]**」ドロップダウンリストで、「**[!UICONTROL 場所 — ベータ版]**」を選択します。
1. 「**[!UICONTROL 条件タイプ]**」で「**[!UICONTROL 市区町村]**」を選択します。
1. 条件名を入力します。例えば、SF ]**の**[!UICONTROL &#x200B;喫茶店を入力します。
1. 右側のウィンドウで「**[!UICONTROL 現在の POI]**」をクリックし、ドロップダウンリストで「**[!UICONTROL サンフランシスコ]**」を市区町村の 1 つとして選択します。
1. 「**[!UICONTROL 変更を保存]**」をクリックします。

### アクションの作成

1. 「**[!UICONTROL アクション]**」セクションで、「**[!UICONTROL +追加]**」をクリックします。
1. 「**[!UICONTROL 拡張機能]**」ドロップダウンリストで、デフォルトの「**[!UICONTROL モバイルコア]**」オプションを選択したままにします。
1. アクションのタイプを選択します（例：**[!UICONTROL ポストバックを送信]**）。

   a.**[!UICONTROL URL]**&#x200B;に、SlackのポストバックURLを入力します（例：`https://hooks.slack.com/services/`）。

   b.投稿の本文を送信するには、「**[!UICONTROL 投稿の本文]**」追加チェックボックスをオンにします。

   c. **[!UICONTROL 投稿本文]**&#x200B;に投稿本文を追加します。例：`{ "text": "A customer has entered" }`

   c.コンテンツタイプを&#x200B;**[!UICONTROL application/json]**&#x200B;のように入力します。

   d.タイムアウト値を選択します（例：**[!UICONTROL 5]**）。

1. 「**[!UICONTROL 変更を保存]**」をクリックします。

### ルールを発行する

1. ルールをアクティブ化するには、発行する必要があります。 Experience Platform Launchでのルールの発行について詳しくは、[発行](https://docs.adobe.com/content/help/ja-JP/launch/using/reference/publish/overview.html)を参照してください。

### 入口と出口を越えた考え方

Places ServiceのGeoFenceのエントリと出口をExperience Platform Launchでトリガールールに使用することは非常に強力ですが、場所データを他のイベントが実行できる条件として使用することもできます。 例えば、アプリ内の特定のtrackAction呼び出しイベントに基づいて起動する準備ができたMobileコア追跡アクションイベントトリガーを設定できます。 このイベントに基づいて、アクションが実行される前に、追加の場所条件をイベントに配置できます。 例えば、購入`trackAction`イベントが発生したが、現在の場所に特定のPlaces Serviceメタデータが含まれている場合は&#x200B;**のみ**&#x200B;のアプリ内調査を開きます。

![条件を作る](/help/assets/places-condition.png)